{
  "type": "object",
  "properties": {
    "$schema": { "type": "string" },
    "extends": { "type": "string" },
    "canActIndependently": { "type": "boolean" },
    "ignoreDiscovery": { "default": false, "type": "boolean" },
    "proxyType": {
      "enum": [
        "new Arbitrum proxy",
        "call implementation proxy",
        "zkSync Lite proxy",
        "zkSpace proxy",
        "Eternal Storage proxy",
        "Polygon Extension proxy",
        "Optics Beacon proxy",
        "Axelar proxy",
        "LightLink proxy",
        "Everclear proxy",
        "immutable"
      ]
    },
    "ignoreInWatchMode": { "type": "array", "items": { "type": "string" } },
    "ignoreMethods": {
      "default": [],
      "type": "array",
      "items": { "type": "string" }
    },
    "ignoreRelatives": {
      "default": [],
      "type": "array",
      "items": { "type": "string" }
    },
    "methods": {
      "default": {},
      "type": "object",
      "propertyNames": { "type": "string" },
      "additionalProperties": { "type": "string" }
    },
    "manualSourcePaths": {
      "default": {},
      "type": "object",
      "propertyNames": { "type": "string" },
      "additionalProperties": { "type": "string" }
    },
    "types": {
      "default": {},
      "type": "object",
      "propertyNames": { "type": "string" },
      "additionalProperties": {
        "type": "object",
        "properties": {
          "typeCaster": { "type": "string" },
          "arg": {
            "type": "object",
            "propertyNames": { "type": "string" },
            "additionalProperties": {
              "anyOf": [{ "type": "string" }, { "type": "number" }]
            }
          },
          "description": { "type": "string" },
          "severity": { "enum": ["HIGH", "LOW"] }
        },
        "required": []
      }
    },
    "displayName": { "type": "string" },
    "categories": {
      "type": "object",
      "propertyNames": { "type": "string" },
      "additionalProperties": {
        "type": "object",
        "properties": {
          "name": { "type": "string" },
          "priority": { "type": "number" }
        },
        "required": ["name", "priority"]
      }
    },
    "category": { "type": "string" },
    "description": { "type": "string" },
    "references": {
      "type": "array",
      "items": {
        "type": "object",
        "properties": {
          "text": { "type": "string" },
          "href": { "type": "string" }
        },
        "required": ["text", "href"]
      }
    },
    "fields": {
      "type": "object",
      "propertyNames": { "type": "string" },
      "additionalProperties": {
        "type": "object",
        "properties": {
          "permissions": {
            "type": "array",
            "items": {
              "type": "object",
              "properties": {
                "type": {
                  "enum": [
                    "challenge",
                    "guard",
                    "propose",
                    "sequence",
                    "validate",
                    "operateLinea",
                    "fastconfirm",
                    "validateZkStack",
                    "validateBridge",
                    "validateBridge2",
                    "validateBridge3",
                    "relay",
                    "aggregatePolygon",
                    "operateStarknet",
                    "operateStarkEx",
                    "governStarknet",
                    "member",
                    "act",
                    "interact",
                    "upgrade"
                  ]
                },
                "delay": {
                  "default": 0,
                  "anyOf": [{ "type": "number" }, { "type": "string" }]
                },
                "description": { "type": "string" },
                "condition": { "type": "string" }
              },
              "required": ["type", "delay"]
            }
          },
          "description": { "type": "string" },
          "severity": { "enum": ["HIGH", "LOW"] },
          "type": {
            "anyOf": [
              {
                "enum": [
                  "CODE_CHANGE",
                  "L2",
                  "EXTERNAL",
                  "RISK_PARAMETER",
                  "PERMISSION"
                ]
              },
              {
                "type": "array",
                "items": {
                  "enum": [
                    "CODE_CHANGE",
                    "L2",
                    "EXTERNAL",
                    "RISK_PARAMETER",
                    "PERMISSION"
                  ]
                }
              }
            ]
          },
          "handler": {
            "anyOf": [
              {
                "type": "object",
                "properties": {
                  "type": { "const": "storage" },
                  "slot": {
                    "anyOf": [
                      {
                        "anyOf": [
                          {
                            "type": "integer",
                            "minimum": 0,
                            "maximum": 9007199254740991
                          },
                          {},
                          {},
                          {
                            "type": "string",
                            "format": "regex",
                            "pattern": "^\\{\\{\\s*[$a-z_][$.a-z\\d_]*\\s*\\}\\}$"
                          }
                        ]
                      },
                      {
                        "minItems": 1,
                        "type": "array",
                        "items": {
                          "anyOf": [
                            {
                              "type": "integer",
                              "minimum": 0,
                              "maximum": 9007199254740991
                            },
                            {},
                            {},
                            {
                              "type": "string",
                              "format": "regex",
                              "pattern": "^\\{\\{\\s*[$a-z_][$.a-z\\d_]*\\s*\\}\\}$"
                            }
                          ]
                        }
                      }
                    ]
                  },
                  "offset": {
                    "anyOf": [
                      {
                        "type": "integer",
                        "minimum": 0,
                        "maximum": 9007199254740991
                      },
                      {},
                      {
                        "type": "string",
                        "format": "regex",
                        "pattern": "^\\{\\{\\s*[$a-z_][$.a-z\\d_]*\\s*\\}\\}$"
                      }
                    ]
                  },
                  "returnType": {
                    "enum": ["address", "bytes", "number", "uint8"]
                  },
                  "ignoreRelative": { "type": "boolean" }
                },
                "required": ["type", "slot"],
                "additionalProperties": false
              },
              {
                "type": "object",
                "properties": {
                  "type": { "const": "dynamicArray" },
                  "slot": {
                    "anyOf": [
                      {
                        "type": "integer",
                        "minimum": 0,
                        "maximum": 9007199254740991
                      },
                      {},
                      {},
                      {
                        "type": "string",
                        "format": "regex",
                        "pattern": "^\\{\\{\\s*[$a-z_][$.a-z\\d_]*\\s*\\}\\}$"
                      }
                    ]
                  },
                  "returnType": { "enum": ["address"] },
                  "ignoreRelative": { "type": "boolean" }
                },
                "required": ["type", "slot"],
                "additionalProperties": false
              },
              {
                "type": "object",
                "properties": {
                  "type": { "const": "dynamicArray" },
                  "slot": {
                    "anyOf": [
                      {
                        "type": "integer",
                        "minimum": 0,
                        "maximum": 9007199254740991
                      },
                      {},
                      {},
                      {
                        "type": "string",
                        "format": "regex",
                        "pattern": "^\\{\\{\\s*[$a-z_][$.a-z\\d_]*\\s*\\}\\}$"
                      }
                    ]
                  },
                  "returnType": { "enum": ["address"] },
                  "ignoreRelative": { "type": "boolean" }
                },
                "required": ["type", "slot"],
                "additionalProperties": false
              },
              {
                "type": "object",
                "properties": {
                  "type": { "const": "array" },
                  "indices": {
                    "anyOf": [
                      { "type": "array", "items": { "type": "number" } },
                      { "type": "string" }
                    ]
                  },
                  "method": { "type": "string" },
                  "length": {
                    "anyOf": [
                      {
                        "type": "integer",
                        "minimum": 0,
                        "maximum": 9007199254740991
                      },
                      {
                        "type": "string",
                        "format": "regex",
                        "pattern": "^\\{\\{\\s*[$a-z_][$.a-z\\d_]*\\s*\\}\\}$"
                      }
                    ]
                  },
                  "maxLength": {
                    "type": "integer",
                    "minimum": 0,
                    "maximum": 9007199254740991
                  },
                  "startIndex": {
                    "type": "integer",
                    "minimum": 0,
                    "maximum": 9007199254740991
                  },
                  "ignoreRelative": { "type": "boolean" }
                },
                "required": ["type"],
                "additionalProperties": false
              },
              {
                "type": "object",
                "properties": {
                  "type": { "const": "call" },
                  "method": { "type": "string" },
                  "args": {
                    "type": "array",
                    "items": {
                      "anyOf": [{ "type": "string" }, { "type": "number" }]
                    }
                  },
                  "ignoreRelative": { "type": "boolean" },
                  "expectRevert": { "type": "boolean" },
                  "address": { "type": "string" }
                },
                "required": ["type", "args"],
                "additionalProperties": false
              },
              {
                "anyOf": [
                  {
                    "type": "object",
                    "properties": {
                      "type": { "const": "event" },
                      "select": {
                        "anyOf": [
                          { "type": "string" },
                          { "type": "array", "items": { "type": "string" } }
                        ]
                      },
                      "groupBy": { "type": "string" },
                      "ignoreRelative": { "type": "boolean" },
                      "set": {
                        "anyOf": [
                          {
                            "type": "object",
                            "properties": {
                              "event": {
                                "anyOf": [
                                  { "type": "string" },
                                  {
                                    "type": "array",
                                    "items": { "type": "string" }
                                  }
                                ]
                              },
                              "where": {}
                            },
                            "required": ["event"]
                          },
                          {
                            "type": "array",
                            "items": {
                              "type": "object",
                              "properties": {
                                "event": {
                                  "anyOf": [
                                    { "type": "string" },
                                    {
                                      "type": "array",
                                      "items": { "type": "string" }
                                    }
                                  ]
                                },
                                "where": {}
                              },
                              "required": ["event"]
                            }
                          }
                        ]
                      },
                      "add": { "type": "null" },
                      "remove": { "type": "null" }
                    },
                    "required": ["type", "set"]
                  },
                  {
                    "type": "object",
                    "properties": {
                      "type": { "const": "event" },
                      "select": {
                        "anyOf": [
                          { "type": "string" },
                          { "type": "array", "items": { "type": "string" } }
                        ]
                      },
                      "groupBy": { "type": "string" },
                      "ignoreRelative": { "type": "boolean" },
                      "set": { "type": "null" },
                      "add": {
                        "anyOf": [
                          {
                            "type": "object",
                            "properties": {
                              "event": {
                                "anyOf": [
                                  { "type": "string" },
                                  {
                                    "type": "array",
                                    "items": { "type": "string" }
                                  }
                                ]
                              },
                              "where": {}
                            },
                            "required": ["event"]
                          },
                          {
                            "type": "array",
                            "items": {
                              "type": "object",
                              "properties": {
                                "event": {
                                  "anyOf": [
                                    { "type": "string" },
                                    {
                                      "type": "array",
                                      "items": { "type": "string" }
                                    }
                                  ]
                                },
                                "where": {}
                              },
                              "required": ["event"]
                            }
                          }
                        ]
                      },
                      "remove": {
                        "anyOf": [
                          {
                            "type": "object",
                            "properties": {
                              "event": {
                                "anyOf": [
                                  { "type": "string" },
                                  {
                                    "type": "array",
                                    "items": { "type": "string" }
                                  }
                                ]
                              },
                              "where": {}
                            },
                            "required": ["event"]
                          },
                          {
                            "type": "array",
                            "items": {
                              "type": "object",
                              "properties": {
                                "event": {
                                  "anyOf": [
                                    { "type": "string" },
                                    {
                                      "type": "array",
                                      "items": { "type": "string" }
                                    }
                                  ]
                                },
                                "where": {}
                              },
                              "required": ["event"]
                            }
                          }
                        ]
                      }
                    },
                    "required": ["type", "add"]
                  }
                ]
              },
              {
                "type": "object",
                "properties": {
                  "type": { "const": "starkWareNamedStorage" },
                  "tag": { "type": "string" },
                  "returnType": { "enum": ["address", "bytes", "number"] },
                  "ignoreRelative": { "type": "boolean" }
                },
                "required": ["type", "tag"],
                "additionalProperties": false
              },
              {
                "type": "object",
                "properties": {
                  "type": { "const": "accessControl" },
                  "roleNames": {
                    "type": "object",
                    "propertyNames": {
                      "type": "string",
                      "format": "regex",
                      "pattern": "^0x[a-f\\d]{64}$"
                    },
                    "additionalProperties": { "type": "string" }
                  },
                  "pickRoleMembers": { "type": "string" },
                  "ignoreRelative": { "type": "boolean" }
                },
                "required": ["type"],
                "additionalProperties": false
              },
              {
                "type": "object",
                "properties": {
                  "type": { "const": "scrollAccessControl" },
                  "roleNames": {
                    "type": "object",
                    "propertyNames": {
                      "type": "string",
                      "format": "regex",
                      "pattern": "^0x[a-f\\d]{64}$"
                    },
                    "additionalProperties": { "type": "string" }
                  },
                  "ignoreRelative": { "type": "boolean" }
                },
                "required": ["type"],
                "additionalProperties": false
              },
              {
                "type": "object",
                "properties": {
                  "type": { "const": "kintoAccessControl" },
                  "roleNames": {
                    "type": "object",
                    "propertyNames": {
                      "type": "string",
                      "format": "regex",
                      "pattern": "^0x[a-f\\d]*$"
                    },
                    "additionalProperties": { "type": "string" }
                  },
                  "ignoreRelative": { "type": "boolean" }
                },
                "required": ["type"],
                "additionalProperties": false
              },
              {
                "type": "object",
                "properties": {
                  "type": { "const": "lineaRolesModule" },
                  "roleNames": {
                    "type": "object",
                    "propertyNames": {
                      "type": "string",
                      "format": "regex",
                      "pattern": "^0x[a-f\\d]{64}$"
                    },
                    "additionalProperties": { "type": "string" }
                  },
                  "ignoreRelative": { "type": "boolean" }
                },
                "required": ["type"],
                "additionalProperties": false
              },
              {
                "type": "object",
                "properties": {
                  "type": { "const": "constructorArgs" },
                  "nameArgs": { "type": "boolean" }
                },
                "required": ["type"],
                "additionalProperties": false
              },
              {
                "type": "object",
                "properties": {
                  "type": { "const": "eventCount" },
                  "topics": {
                    "type": "array",
                    "items": {
                      "anyOf": [{ "type": "string" }, { "type": "null" }]
                    }
                  }
                },
                "required": ["type", "topics"],
                "additionalProperties": false
              },
              {
                "type": "object",
                "properties": { "type": { "const": "hardcoded" }, "value": {} },
                "required": ["type", "value"],
                "additionalProperties": false
              },
              {
                "type": "object",
                "properties": {
                  "type": { "const": "starkWareGovernance" },
                  "filterBy": { "type": "string" }
                },
                "required": ["type", "filterBy"],
                "additionalProperties": false
              },
              {
                "type": "object",
                "properties": { "type": { "const": "layerZeroMultisig" } },
                "required": ["type"],
                "additionalProperties": false
              },
              {
                "type": "object",
                "properties": {
                  "type": { "const": "arbitrumActors" },
                  "actorType": {
                    "anyOf": [
                      { "const": "validator" },
                      { "const": "batchPoster" }
                    ]
                  }
                },
                "required": ["type", "actorType"],
                "additionalProperties": false
              },
              {
                "type": "object",
                "properties": {
                  "type": { "const": "arbitrumScheduledTransactions" }
                },
                "required": ["type"],
                "additionalProperties": false
              },
              {
                "type": "object",
                "properties": {
                  "type": { "const": "opStackDA" },
                  "sequencerAddress": { "type": "string" }
                },
                "required": ["type", "sequencerAddress"],
                "additionalProperties": false
              },
              {
                "type": "object",
                "properties": {
                  "type": { "const": "opStackSequencerInbox" },
                  "sequencerAddress": { "type": "string" }
                },
                "required": ["type", "sequencerAddress"],
                "additionalProperties": false
              },
              {
                "type": "object",
                "properties": {
                  "type": { "const": "arbitrumSequencerVersion" }
                },
                "required": ["type"],
                "additionalProperties": false
              },
              {
                "type": "object",
                "properties": { "type": { "const": "arbitrumDACKeyset" } },
                "required": ["type"],
                "additionalProperties": false
              },
              {
                "type": "object",
                "properties": {
                  "type": { "const": "eip2535Facets" },
                  "ignoreRelative": { "type": "boolean" }
                },
                "required": ["type"],
                "additionalProperties": false
              },
              {
                "type": "object",
                "properties": {
                  "type": { "const": "zksynceraScheduledTransactions" }
                },
                "required": ["type"],
                "additionalProperties": false
              },
              {
                "type": "object",
                "properties": { "type": { "const": "zksynceraValidators" } },
                "required": ["type"],
                "additionalProperties": false
              },
              {
                "type": "object",
                "properties": { "type": { "const": "orbitPostsBlobs" } },
                "required": ["type"],
                "additionalProperties": false
              },
              {
                "type": "object",
                "properties": {
                  "type": { "const": "polygoncdkScheduledTransactions" }
                },
                "required": ["type"],
                "additionalProperties": false
              }
            ]
          },
          "template": { "type": "string" },
          "copy": { "type": "string" },
          "edit": {}
        },
        "required": []
      }
    }
  },
  "required": [
    "ignoreDiscovery",
    "ignoreMethods",
    "ignoreRelatives",
    "methods",
    "manualSourcePaths",
    "types"
  ],
  "$schema": "https://json-schema.org/draft-2020-12/schema"
}
